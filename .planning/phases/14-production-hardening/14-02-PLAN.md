---
phase: 14-production-hardening
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/public/icons/icon-192.png
  - frontend/public/icons/icon-512.png
  - frontend/public/apple-touch-icon.png
  - frontend/index.html
  - frontend/vite.config.ts
autonomous: false

must_haves:
  truths:
    - "PWA icons are actual PNG files (not SVG with .png extension)"
    - "192x192 and 512x512 icons display correctly on Android home screen"
    - "Apple touch icon displays correctly on iOS home screen"
  artifacts:
    - path: "frontend/public/icons/icon-192.png"
      provides: "192x192 PNG icon for PWA manifest"
      min_size_bytes: 5000
    - path: "frontend/public/icons/icon-512.png"
      provides: "512x512 PNG icon for PWA manifest"
      min_size_bytes: 10000
    - path: "frontend/public/apple-touch-icon.png"
      provides: "180x180 PNG for iOS home screen"
      min_size_bytes: 3000
    - path: "frontend/index.html"
      provides: "Apple touch icon link"
      contains: "apple-touch-icon"
  key_links:
    - from: "frontend/index.html"
      to: "frontend/public/apple-touch-icon.png"
      via: "link rel=apple-touch-icon"
      pattern: 'rel="apple-touch-icon"'
---

<objective>
Replace SVG placeholder icons with proper PNG assets for PWA home screen installation on iOS and Android.

Purpose: Current icon files are SVG content with .png extensions, causing display issues when users add the app to their home screens. Production PWA requires actual PNG images in correct dimensions.

Output: Proper PNG icons at 192x192, 512x512, and 180x180 (apple-touch-icon) that display correctly on mobile home screens.
</objective>

<execution_context>
@/Users/tvellore/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tvellore/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing PWA configuration
@frontend/public/icons/icon.svg
@frontend/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate proper PNG icons from SVG source</name>
  <files>
    frontend/public/icons/icon-192.png
    frontend/public/icons/icon-512.png
    frontend/public/apple-touch-icon.png
  </files>
  <action>
    The current icons at frontend/public/icons/icon-192.png and icon-512.png are SVG files with .png extension.
    Need to convert the SVG to actual PNG files.

    1. Read the existing SVG source from frontend/public/icons/icon.svg

    2. Use sharp (already available in node_modules) or an alternative approach:
       - Create a temporary script to convert SVG to PNG at required sizes
       - Or use ImageMagick if available: `convert -background none -resize 192x192 icon.svg icon-192.png`
       - Or create PNG programmatically using canvas/sharp

    3. Generate three PNG files:
       - icon-192.png: 192x192 pixels, PNG format
       - icon-512.png: 512x512 pixels, PNG format
       - apple-touch-icon.png: 180x180 pixels, PNG format (goes in frontend/public/ not icons/)

    4. Verify files are actual PNGs using `file` command:
       ```bash
       file frontend/public/icons/icon-192.png  # Should say "PNG image data"
       ```

    Design note: The icon should be the OnCall platform logo. If SVG is abstract/generic, create a simple but recognizable icon:
    - Background: slate-900 (#0f172a) - matches theme_color in manifest
    - Foreground: Bell/alert icon in white or accent color
    - Include "OC" or simple icon that's recognizable at small sizes

    If sharp is not installed, install it: `npm install --save-dev sharp` in frontend/
  </action>
  <verify>
    file frontend/public/icons/icon-192.png | grep "PNG image"
    file frontend/public/icons/icon-512.png | grep "PNG image"
    file frontend/public/apple-touch-icon.png | grep "PNG image"
    Verify file sizes are appropriate (PNGs should be 5KB+ for 192, 10KB+ for 512)
  </verify>
  <done>
    All icon files are actual PNG format at correct dimensions.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update HTML and manifest configuration</name>
  <files>
    frontend/index.html
    frontend/vite.config.ts
  </files>
  <action>
    1. Update frontend/index.html to add apple-touch-icon link in head:
       ```html
       <link rel="apple-touch-icon" href="/apple-touch-icon.png">
       ```
       Also update favicon reference if needed.

    2. Verify frontend/vite.config.ts PWA manifest configuration includes:
       - icons with src pointing to /icons/icon-192.png and /icons/icon-512.png
       - purpose: "any maskable" for the 512 icon
       - Correct MIME types (image/png)

    3. Ensure manifest.webmanifest (generated by vite-plugin-pwa) will reference correct paths.

    Note: The manifest.webmanifest in frontend/dist/ is generated at build time.
    The source config is in vite.config.ts VitePWA plugin options.
  </action>
  <verify>
    Run `npm run build` in frontend/ directory
    Check frontend/dist/manifest.webmanifest contains correct icon paths
    Verify apple-touch-icon link exists in index.html
  </verify>
  <done>
    HTML includes apple-touch-icon. Manifest configuration correct for PNG icons.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    PWA icons converted from SVG placeholders to actual PNG files:
    - 192x192 icon for Android/PWA
    - 512x512 icon for splash screens
    - 180x180 apple-touch-icon for iOS

    HTML updated with apple-touch-icon link.
  </what-built>
  <how-to-verify>
    1. Start the frontend dev server: `cd frontend && npm run dev`
    2. Open Chrome DevTools > Application > Manifest
       - Verify icons load without errors
       - Check icon preview shows actual image (not broken)

    3. iOS verification (if available):
       - Open site in Safari on iOS
       - Tap Share > Add to Home Screen
       - Verify icon appears correctly on home screen

    4. Android verification (if available):
       - Open site in Chrome on Android
       - Tap menu > Add to Home Screen (or install prompt)
       - Verify icon appears correctly

    5. Quick verification: `file frontend/public/icons/*.png` should all say "PNG image data"
  </how-to-verify>
  <resume-signal>Type "approved" if icons display correctly, or describe issues seen</resume-signal>
</task>

</tasks>

<verification>
1. `file frontend/public/icons/icon-192.png` returns "PNG image data"
2. `file frontend/public/icons/icon-512.png` returns "PNG image data"
3. `file frontend/public/apple-touch-icon.png` returns "PNG image data"
4. Frontend builds successfully
5. Chrome DevTools shows icons loading in manifest
</verification>

<success_criteria>
- [ ] icon-192.png is actual PNG at 192x192
- [ ] icon-512.png is actual PNG at 512x512
- [ ] apple-touch-icon.png exists at 180x180
- [ ] index.html includes apple-touch-icon link
- [ ] Icons display in Chrome DevTools manifest panel
</success_criteria>

<output>
After completion, create `.planning/phases/14-production-hardening/14-02-SUMMARY.md`
</output>
